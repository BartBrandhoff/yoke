<!DOCTYPE html><html><head><title>Yoke.java</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../../../../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../../../../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/Engine.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / </span><span class="file_name">Engine.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/Yoke.java.html" class="source selected"><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / </span><span class="file_name">Yoke.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/TRACE.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">TRACE.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/ALL.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">ALL.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/PATCH.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">PATCH.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/CONNECT.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">CONNECT.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/GET.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">GET.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/HEAD.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">HEAD.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/Path.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">Path.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/PUT.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">PUT.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/Consumes.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">Consumes.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/DELETE.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">DELETE.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/OPTIONS.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">OPTIONS.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/Produces.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">Produces.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/annotations/POST.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / annotations / </span><span class="file_name">POST.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/MimeType.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / </span><span class="file_name">MimeType.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/engine/Function.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / engine / </span><span class="file_name">Function.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/engine/StringPlaceholderEngine.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / engine / </span><span class="file_name">StringPlaceholderEngine.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/engine/AbstractEngine.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / engine / </span><span class="file_name">AbstractEngine.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/filters/DeflateWriterFilter.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / filters / </span><span class="file_name">DeflateWriterFilter.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/filters/WriterFilter.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / filters / </span><span class="file_name">WriterFilter.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/filters/GZipWriterFilter.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / filters / </span><span class="file_name">GZipWriterFilter.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/filters/AbstractWriterFilter.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / filters / </span><span class="file_name">AbstractWriterFilter.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/RequestProxy.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">RequestProxy.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/AuthHandler.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">AuthHandler.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/YokeRequest.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">YokeRequest.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/MethodOverride.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">MethodOverride.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/BasicAuth.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">BasicAuth.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Timeout.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Timeout.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Csrf.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Csrf.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/FormAuth.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">FormAuth.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Logger.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Logger.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/YokeCookie.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">YokeCookie.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Static.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Static.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/CookieParser.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">CookieParser.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/ResponseTime.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">ResponseTime.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/BodyParser.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">BodyParser.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/ErrorHandler.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">ErrorHandler.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Session.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Session.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Compress.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Compress.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/BridgeSecureHandler.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">BridgeSecureHandler.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Vhost.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Vhost.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/YokeFileUpload.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">YokeFileUpload.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Favicon.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Favicon.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Limit.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Limit.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/YokeResponse.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">YokeResponse.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/middleware/Router.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">Router.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/store/SessionStore.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / store / </span><span class="file_name">SessionStore.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/store/SharedDataSessionStore.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / store / </span><span class="file_name">SharedDataSessionStore.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/store/RedisSessionStore.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / store / </span><span class="file_name">RedisSessionStore.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/util/AsyncIterator.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / util / </span><span class="file_name">AsyncIterator.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/util/LRUCache.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / util / </span><span class="file_name">LRUCache.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/util/Utils.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / util / </span><span class="file_name">Utils.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/test/Response.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / test / </span><span class="file_name">Response.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/test/YokeTester.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / test / </span><span class="file_name">YokeTester.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/Middleware.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / </span><span class="file_name">Middleware.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/YokeAsyncResult.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / </span><span class="file_name">YokeAsyncResult.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/JSON.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / </span><span class="file_name">JSON.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/impl/ThreadLocalUTCDateFormat.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / impl / </span><span class="file_name">ThreadLocalUTCDateFormat.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/YokeException.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / </span><span class="file_name">YokeException.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/Context.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / </span><span class="file_name">Context.java</span></a><a href="../../../../../../../../framework/src/main/java/com/jetdrone/vertx/yoke/core/RequestWrapper.java.html" class="source "><span class="base_path">framework / src / main / java / com / jetdrone / vertx / yoke / core / </span><span class="file_name">RequestWrapper.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/engine/GroovyTemplateEngine.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / engine / </span><span class="file_name">GroovyTemplateEngine.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/GYoke.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / </span><span class="file_name">GYoke.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GRouter.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GRouter.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GYokeRequest.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GYokeRequest.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GFormAuth.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GFormAuth.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GBasicAuth.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GBasicAuth.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GYokeFileUpload.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GYokeFileUpload.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/middleware/GYokeResponse.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / middleware / </span><span class="file_name">GYokeResponse.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/store/GSharedDataSessionStore.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / store / </span><span class="file_name">GSharedDataSessionStore.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/test/GYokeTester.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / test / </span><span class="file_name">GYokeTester.java</span></a><a href="../../../../../../../../framework/src/main/groovy/com/jetdrone/vertx/yoke/core/GMultiMap.java.html" class="source "><span class="base_path">framework / src / main / groovy / com / jetdrone / vertx / yoke / core / </span><span class="file_name">GMultiMap.java</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/engine/MicroTemplateEngine.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / engine / </span><span class="file_name">MicroTemplateEngine.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/CookieParser.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">CookieParser.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Timeout.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Timeout.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Router.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Router.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Logger.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Logger.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/ErrorHandler.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">ErrorHandler.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Session.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Session.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/ResponseTime.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">ResponseTime.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Vhost.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Vhost.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/BodyParser.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">BodyParser.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Favicon.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Favicon.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/BasicAuth.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">BasicAuth.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Limit.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Limit.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/Static.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">Static.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/middleware/MethodOverride.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / middleware / </span><span class="file_name">MethodOverride.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/util/Utils.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / util / </span><span class="file_name">Utils.js</span></a><a href="../../../../../../../../framework/src/main/resources/yoke/Yoke.js.html" class="source "><span class="base_path">framework / src / main / resources / yoke / </span><span class="file_name">Yoke.js</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>Yoke.java</h1><div class="filepath">framework/src/main/java/com/jetdrone/vertx/yoke/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Copyright 2011-2014 the original author or authors.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">jetdrone</span><span class="o">.</span><span class="na">vertx</span><span class="o">.</span><span class="na">yoke</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.core.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.core.RequestWrapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.middleware.YokeRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.middleware.YokeResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.store.SessionStore</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.store.SharedDataSessionStore</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.jetdrone.vertx.yoke.core.YokeException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">io.netty.handler.codec.http.HttpResponseStatus</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.AsyncResult</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.Handler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.Vertx</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.http.HttpServer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.http.HttpServerRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.http.HttpServerResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.json.JsonElement</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.core.json.JsonObject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.platform.Container</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.vertx.java.platform.Verticle</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><h1>Yoke</h1></div><div class="body"><p>Yoke is a chain executor of middleware for Vert.x 2.x. The goal of this library is not to provide a web application<br />framework but the backbone that helps the creation of web applications.</p>

<p>Yoke works in a similar way to Connect middleware. Users start by declaring which middleware components want to use<br />and then start an http server either managed by Yoke or provided by the user (say when you need https).</p>

<p>Yoke has no extra dependencies than Vert.x itself so it is self contained.</p></div></div>
</td><td class="code"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Yoke</span> <span class="kd">implements</span> <span class="n">RequestWrapper</span> <span class="o">{</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Vert.x instance</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Vertx</span> <span class="n">vertx</span><span class="o">;</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Vert.x container</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Container</span> <span class="n">container</span><span class="o">;</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>request wrapper in use</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">RequestWrapper</span> <span class="n">requestWrapper</span><span class="o">;</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>default context used by all requests</p></div><div class="body"><pre>
{
  title: "Yoke",
  x-powered-by: true,
  trust-proxy: true
}
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">protected</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">defaultContext</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>The internal registry of <a href="Engine.html">render engines</a></p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Engine</span><span class="o">&gt;</span> <span class="n">engineMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a Yoke instance.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>the </span><span class="dox_type">verticle</span><span>- main verticle</span></div></div><div class="body"><p>This constructor should be called from a verticle and pass a valid Vertx instance. This instance will be shared<br />with all registered middleware. The reason behind this is to allow middleware to use Vertx features such as file<br />system and timers.</p>

<pre>
public class MyVerticle extends Verticle {
  public void start() {
    final Yoke yoke = new Yoke(this);
    ...
  }
}
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="nf">Yoke</span><span class="o">(</span><span class="n">Verticle</span> <span class="n">verticle</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">verticle</span><span class="o">.</span><span class="na">getVertx</span><span class="o">(),</span> <span class="n">verticle</span><span class="o">.</span><span class="na">getContainer</span><span class="o">(),</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a Yoke instance.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">vertx</span></div></div><div class="body"><p>This constructor should be called from a verticle and pass a valid Vertx instance and a Logger. This instance<br />will be shared with all registered middleware. The reason behind this is to allow middleware to use Vertx<br />features such as file system and timers.</p>

<pre>
public class MyVerticle extends Verticle {
  public void start() {
    final Yoke yoke = new Yoke(getVertx());
    ...
  }
}
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="nf">Yoke</span><span class="o">(</span><span class="n">Vertx</span> <span class="n">vertx</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">vertx</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a Yoke instance.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">vertx</span></div></div><div class="body"><p>This constructor should be called from a verticle and pass a valid Vertx instance and a Container. This instance<br />will be shared with all registered middleware. The reason behind this is to allow middleware to use Vertx<br />features such as file system and timers.</p>

<pre>
public class MyVerticle extends Verticle {
  public void start() {
    final Yoke yoke = new Yoke(getVertx());
    ...
  }
}
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="nf">Yoke</span><span class="o">(</span><span class="n">Vertx</span> <span class="n">vertx</span><span class="o">,</span> <span class="n">Container</span> <span class="n">container</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">vertx</span><span class="o">,</span> <span class="n">container</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Creates a Yoke instance.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">vertx</span></div><div class="dox_tag_detail"><span> </span><span class="dox_type">container</span></div><div class="dox_tag_detail"><span> </span><span class="dox_type">requestWrapper</span></div></div><div class="body"><p>This constructor should be called internally or from other language bindings.</p>

<pre>
public class MyVerticle extends Verticle {
  public void start() {
    final Yoke yoke = new Yoke(getVertx(),
        getContainer(),
        new RequestWrapper() {...});
    ...
  }
}
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="nf">Yoke</span><span class="o">(</span><span class="n">Vertx</span> <span class="n">vertx</span><span class="o">,</span> <span class="n">Container</span> <span class="n">container</span><span class="o">,</span> <span class="n">RequestWrapper</span> <span class="n">requestWrapper</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">vertx</span> <span class="o">=</span> <span class="n">vertx</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">container</span> <span class="o">=</span> <span class="n">container</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">requestWrapper</span> <span class="o">=</span> <span class="n">requestWrapper</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="k">this</span> <span class="o">:</span> <span class="n">requestWrapper</span><span class="o">;</span>
        <span class="n">defaultContext</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;title&quot;</span><span class="o">,</span> <span class="s">&quot;Yoke&quot;</span><span class="o">);</span>
        <span class="n">defaultContext</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;x-powered-by&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
        <span class="n">defaultContext</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;trust-proxy&quot;</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
        <span class="n">store</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SharedDataSessionStore</span><span class="o">(</span><span class="n">vertx</span><span class="o">,</span> <span class="s">&quot;yoke.sessiondata&quot;</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Mounted middleware represents a binding of a Middleware instance to a specific url path.</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MountedMiddleware</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">mount</span><span class="o">;</span>
        <span class="kd">final</span> <span class="n">Middleware</span> <span class="n">middleware</span><span class="o">;</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Constructs a new Mounted Middleware</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>Mount </span><span class="dox_type">mount</span><span>- path</span></div><div class="dox_tag_detail"><span>Middleware </span><span class="dox_type">middleware</span><span>- to use on the path.</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">private</span> <span class="nf">MountedMiddleware</span><span class="o">(</span><span class="n">String</span> <span class="n">mount</span><span class="o">,</span> <span class="n">Middleware</span> <span class="n">middleware</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">mount</span> <span class="o">=</span> <span class="n">mount</span><span class="o">;</span>
            <span class="k">this</span><span class="o">.</span><span class="na">middleware</span> <span class="o">=</span> <span class="n">middleware</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Ordered list of mounted middleware in the chain</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="kd">final</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">MountedMiddleware</span><span class="o">&gt;</span> <span class="n">middlewareList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Special middleware used for error handling</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="n">Middleware</span> <span class="n">errorHandler</span><span class="o">;</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a Middleware to the chain. If the middleware is an Error Handler Middleware then it is<br />treated differently and only the last error handler is kept.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">route</span><span>- route prefix for the middleware</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">middleware</span><span>- middleware add to the chain</span></div></div><div class="body"><p>You might want to add a middleware that is only supposed to run on a specific route (path prefix).<br />In this case if the request path does not match the prefix the middleware is skipped automatically.</p>

<pre>
yoke.use("/login", new CustomLoginMiddleware());
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">use</span><span class="o">(</span><span class="n">String</span> <span class="n">route</span><span class="o">,</span> <span class="n">Middleware</span><span class="o">...</span> <span class="n">middleware</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Middleware</span> <span class="n">m</span> <span class="o">:</span> <span class="n">middleware</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>when the type of middleware is error handler then the route is ignored and
the middleware is extracted from the execution chain into a special placeholder
for error handling</p>
</td><td class="code"><div class="highlight"><pre>            <span class="k">if</span> <span class="o">(</span><span class="n">m</span><span class="o">.</span><span class="na">isErrorHandler</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">errorHandler</span> <span class="o">=</span> <span class="n">m</span><span class="o">;</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">middlewareList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">MountedMiddleware</span><span class="o">(</span><span class="n">route</span><span class="o">,</span> <span class="n">m</span><span class="o">));</span>
            <span class="o">}</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>initialize the middleware with the current Vert.x and Logger</p>
</td><td class="code"><div class="highlight"><pre>            <span class="n">m</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">vertx</span><span class="o">,</span> <span class="n">route</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a middleware to the chain with the prefix "/".</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">middleware</span><span>- middleware add to the chain</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">use</span><span class="o">(</span><span class="n">Middleware</span><span class="o">...</span> <span class="n">middleware</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">use</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="n">middleware</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a Handler to a route. The behaviour is similar to the middleware, however this<br />will be a terminal point in the execution chain. In this case any middleware added<br />after will not be executed. However you should care about the route which may lead<br />to skip this middleware.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">route</span><span>- route prefix for the middleware</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">handler</span><span>- Handler to add</span></div></div><div class="body"><p>The idea to user a Handler is to keep the API familiar with the rest of the Vert.x<br />API.</p>

<pre>
yoke.use("/login", new Handler<YokeRequest>() {
  public void handle(YokeRequest request) {
    request.response.end("Hello");
  }
});
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">use</span><span class="o">(</span><span class="n">String</span> <span class="n">route</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">YokeRequest</span><span class="o">&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">middlewareList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">MountedMiddleware</span><span class="o">(</span><span class="n">route</span><span class="o">,</span> <span class="k">new</span> <span class="n">Middleware</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">YokeRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">next</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">handler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}));</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-21"><td class="docs"><div class="pilwrap"><a href="#section-21" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a Handler to a route.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">handler</span><span>- Handler to add</span></div></div><div class="body"><pre>
yoke.use("/login", new Handler<YokeRequest>() {
  public void handle(YokeRequest request) {
    request.response.end("Hello");
  }
});
</pre></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">use</span><span class="o">(</span><span class="n">Handler</span><span class="o">&lt;</span><span class="n">YokeRequest</span><span class="o">&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">use</span><span class="o">(</span><span class="s">&quot;/&quot;</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-22"><td class="docs"><div class="pilwrap"><a href="#section-22" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Adds a Render Engine to the library. Render Engines are Template engines you<br />might want to use to speed the development of your application. Once they are<br />registered you can use the method render in the YokeResponse to<br />render a template.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>The </span><span class="dox_type">extension</span><span>- file extension for this template engine e.g.: .jsp</span></div><div class="dox_tag_detail"><span>The </span><span class="dox_type">engine</span><span>- implementation of the engine</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">engine</span><span class="o">(</span><span class="n">String</span> <span class="n">extension</span><span class="o">,</span> <span class="n">Engine</span> <span class="n">engine</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">engine</span><span class="o">.</span><span class="na">setVertx</span><span class="o">(</span><span class="n">vertx</span><span class="o">);</span>
        <span class="n">engineMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">extension</span><span class="o">,</span> <span class="n">engine</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-23"><td class="docs"><div class="pilwrap"><a href="#section-23" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Special store engine used for accessing session data</p></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">private</span> <span class="n">SessionStore</span> <span class="n">store</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">store</span><span class="o">(</span><span class="n">SessionStore</span> <span class="n">store</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">store</span> <span class="o">=</span> <span class="n">store</span><span class="o">;</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-24"><td class="docs"><div class="pilwrap"><a href="#section-24" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>When you need to share global properties with your requests you can add them<br />to Yoke and on every request they will be available as request.get(String)</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>unique </span><span class="dox_type">key</span><span>- identifier</span></div><div class="dox_tag_detail"><span>Any </span><span class="dox_type">value</span><span>- non null value, nulls are not saved</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">set</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">defaultContext</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">defaultContext</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-25"><td class="docs"><div class="pilwrap"><a href="#section-25" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Starts the server listening at a given port bind to all available interfaces.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>the </span><span class="dox_type">port</span><span>- server TCP port</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Yoke</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">listen</span><span class="o">(</span><span class="kt">int</span> <span class="n">port</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">listen</span><span class="o">(</span><span class="n">port</span><span class="o">,</span> <span class="s">&quot;0.0.0.0&quot;</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-26"><td class="docs"><div class="pilwrap"><a href="#section-26" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Starts the server listening at a given port bind to all available interfaces.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>the </span><span class="dox_type">port</span><span>- server TCP port</span></div><div class="dox_tag_detail"><span>for </span><span class="dox_type">handler</span><span>- asynchronous result of the listen operation</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Yoke</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">listen</span><span class="o">(</span><span class="kt">int</span> <span class="n">port</span><span class="o">,</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">listen</span><span class="o">(</span><span class="n">port</span><span class="o">,</span> <span class="s">&quot;0.0.0.0&quot;</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-27"><td class="docs"><div class="pilwrap"><a href="#section-27" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Starts the server listening at a given port and given address.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>the </span><span class="dox_type">port</span><span>- server TCP port</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Yoke</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">listen</span><span class="o">(</span><span class="kt">int</span> <span class="n">port</span><span class="o">,</span> <span class="n">String</span> <span class="n">address</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">listen</span><span class="o">(</span><span class="n">port</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-28"><td class="docs"><div class="pilwrap"><a href="#section-28" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Starts the server listening at a given port and given address.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span>the </span><span class="dox_type">port</span><span>- server TCP port</span></div><div class="dox_tag_detail"><span>for </span><span class="dox_type">handler</span><span>- asynchronous result of the listen operation</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Yoke</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">listen</span><span class="o">(</span><span class="kt">int</span> <span class="n">port</span><span class="o">,</span> <span class="n">String</span> <span class="n">address</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">HttpServer</span> <span class="n">server</span> <span class="o">=</span> <span class="n">vertx</span><span class="o">.</span><span class="na">createHttpServer</span><span class="o">();</span>

        <span class="n">listen</span><span class="o">(</span><span class="n">server</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">server</span><span class="o">.</span><span class="na">listen</span><span class="o">(</span><span class="n">port</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">AsyncResult</span><span class="o">&lt;</span><span class="n">HttpServer</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">AsyncResult</span><span class="o">&lt;</span><span class="n">HttpServer</span><span class="o">&gt;</span> <span class="n">listen</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">handler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">listen</span><span class="o">.</span><span class="na">succeeded</span><span class="o">());</span>
                <span class="o">}</span>
            <span class="o">});</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">server</span><span class="o">.</span><span class="na">listen</span><span class="o">(</span><span class="n">port</span><span class="o">,</span> <span class="n">address</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-29"><td class="docs"><div class="pilwrap"><a href="#section-29" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Default implementation of the request wrapper</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">request</span></div><div class="dox_tag_detail"><span> </span><span class="dox_type">secure</span></div><div class="dox_tag_detail"><span> </span><span class="dox_type">engines</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">YokeRequest</span> <span class="nf">wrap</span><span class="o">(</span><span class="n">HttpServerRequest</span> <span class="n">request</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">secure</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Engine</span><span class="o">&gt;</span> <span class="n">engines</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-30"><td class="docs"><div class="pilwrap"><a href="#section-30" class="pilcrow">&#182;</a></div><p>the context map is shared with all middlewares</p>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">context</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Context</span><span class="o">(</span><span class="n">defaultContext</span><span class="o">);</span>
        <span class="n">YokeResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="k">new</span> <span class="n">YokeResponse</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">response</span><span class="o">(),</span> <span class="n">context</span><span class="o">,</span> <span class="n">engines</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">YokeRequest</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">,</span> <span class="n">secure</span><span class="o">,</span> <span class="n">context</span><span class="o">,</span> <span class="n">store</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-31"><td class="docs"><div class="pilwrap"><a href="#section-31" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Starts listening at a already created server.</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">server</span></div><div class="dox_tag_title">Returns</div><div class="dox_tag_detail"><span class="dox_type">Yoke</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">listen</span><span class="o">(</span><span class="kd">final</span> <span class="n">HttpServer</span> <span class="n">server</span><span class="o">)</span> <span class="o">{</span></pre></div></td></tr><tr id="section-32"><td class="docs"><div class="pilwrap"><a href="#section-32" class="pilcrow">&#182;</a></div><p>is this server HTTPS?</p>
</td><td class="code"><div class="highlight"><pre>        <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">secure</span> <span class="o">=</span> <span class="n">server</span><span class="o">.</span><span class="na">isSSL</span><span class="o">();</span>

        <span class="n">server</span><span class="o">.</span><span class="na">requestHandler</span><span class="o">(</span><span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">HttpServerRequest</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">HttpServerRequest</span> <span class="n">req</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">final</span> <span class="n">YokeRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">requestWrapper</span><span class="o">.</span><span class="na">wrap</span><span class="o">(</span><span class="n">req</span><span class="o">,</span> <span class="n">secure</span><span class="o">,</span> <span class="n">engineMap</span><span class="o">);</span></pre></div></td></tr><tr id="section-33"><td class="docs"><div class="pilwrap"><a href="#section-33" class="pilcrow">&#182;</a></div><p>add x-powered-by header is enabled</p>
</td><td class="code"><div class="highlight"><pre>                <span class="n">Boolean</span> <span class="n">poweredBy</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;x-powered-by&quot;</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">poweredBy</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">poweredBy</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">request</span><span class="o">.</span><span class="na">response</span><span class="o">().</span><span class="na">putHeader</span><span class="o">(</span><span class="s">&quot;x-powered-by&quot;</span><span class="o">,</span> <span class="s">&quot;yoke&quot;</span><span class="o">);</span>
                <span class="o">}</span>

                <span class="k">new</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;()</span> <span class="o">{</span>
                    <span class="kt">int</span> <span class="n">currentMiddleware</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>

                    <span class="nd">@Override</span>
                    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">Object</span> <span class="n">error</span><span class="o">)</span> <span class="o">{</span>
                        <span class="k">if</span> <span class="o">(</span><span class="n">error</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">currentMiddleware</span><span class="o">++;</span>
                            <span class="k">if</span> <span class="o">(</span><span class="n">currentMiddleware</span> <span class="o">&lt;</span> <span class="n">middlewareList</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span>
                                <span class="n">MountedMiddleware</span> <span class="n">mountedMiddleware</span> <span class="o">=</span> <span class="n">middlewareList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currentMiddleware</span><span class="o">);</span>

                                <span class="k">if</span> <span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">path</span><span class="o">().</span><span class="na">startsWith</span><span class="o">(</span><span class="n">mountedMiddleware</span><span class="o">.</span><span class="na">mount</span><span class="o">))</span> <span class="o">{</span>
                                    <span class="n">Middleware</span> <span class="n">middlewareItem</span> <span class="o">=</span> <span class="n">mountedMiddleware</span><span class="o">.</span><span class="na">middleware</span><span class="o">;</span>
                                    <span class="n">middlewareItem</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
                                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span></pre></div></td></tr><tr id="section-34"><td class="docs"><div class="pilwrap"><a href="#section-34" class="pilcrow">&#182;</a></div><p>the middleware was not mounted on this uri, skip to the next entry</p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="n">handle</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
                                <span class="o">}</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="n">HttpServerResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">response</span><span class="o">();</span></pre></div></td></tr><tr id="section-35"><td class="docs"><div class="pilwrap"><a href="#section-35" class="pilcrow">&#182;</a></div><p>reached the end and no handler was able to answer the request</p>
</td><td class="code"><div class="highlight"><pre>                                <span class="n">response</span><span class="o">.</span><span class="na">setStatusCode</span><span class="o">(</span><span class="mi">404</span><span class="o">);</span>
                                <span class="n">response</span><span class="o">.</span><span class="na">setStatusMessage</span><span class="o">(</span><span class="n">HttpResponseStatus</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">404</span><span class="o">).</span><span class="na">reasonPhrase</span><span class="o">());</span>
                                <span class="k">if</span> <span class="o">(</span><span class="n">errorHandler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                    <span class="n">errorHandler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                    <span class="n">response</span><span class="o">.</span><span class="na">end</span><span class="o">(</span><span class="n">HttpResponseStatus</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">404</span><span class="o">).</span><span class="na">reasonPhrase</span><span class="o">());</span>
                                <span class="o">}</span>
                            <span class="o">}</span>
                        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                            <span class="n">request</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&quot;error&quot;</span><span class="o">,</span> <span class="n">error</span><span class="o">);</span>
                            <span class="k">if</span> <span class="o">(</span><span class="n">errorHandler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">errorHandler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="n">HttpServerResponse</span> <span class="n">response</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">response</span><span class="o">();</span>

                                <span class="kt">int</span> <span class="n">errorCode</span><span class="o">;</span></pre></div></td></tr><tr id="section-36"><td class="docs"><div class="pilwrap"><a href="#section-36" class="pilcrow">&#182;</a></div><p>if the error was set on the response use it</p>
</td><td class="code"><div class="highlight"><pre>                                <span class="k">if</span> <span class="o">(</span><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">()</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="o">)</span> <span class="o">{</span>
                                    <span class="n">errorCode</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">();</span>
                                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span></pre></div></td></tr><tr id="section-37"><td class="docs"><div class="pilwrap"><a href="#section-37" class="pilcrow">&#182;</a></div><p>if it was set as the error object use it</p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="k">if</span> <span class="o">(</span><span class="n">error</span> <span class="k">instanceof</span> <span class="n">Number</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="n">errorCode</span> <span class="o">=</span> <span class="o">((</span><span class="n">Number</span><span class="o">)</span> <span class="n">error</span><span class="o">).</span><span class="na">intValue</span><span class="o">();</span>
                                    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">error</span> <span class="k">instanceof</span> <span class="n">YokeException</span><span class="o">)</span> <span class="o">{</span>
                                        <span class="n">errorCode</span> <span class="o">=</span> <span class="o">((</span><span class="n">YokeException</span><span class="o">)</span> <span class="n">error</span><span class="o">).</span><span class="na">getErrorCode</span><span class="o">().</span><span class="na">intValue</span><span class="o">();</span>
                                    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span></pre></div></td></tr><tr id="section-38"><td class="docs"><div class="pilwrap"><a href="#section-38" class="pilcrow">&#182;</a></div><p>default error code</p>
</td><td class="code"><div class="highlight"><pre>                                        <span class="n">errorCode</span> <span class="o">=</span> <span class="mi">500</span><span class="o">;</span>
                                    <span class="o">}</span>
                                <span class="o">}</span>

                                <span class="n">response</span><span class="o">.</span><span class="na">setStatusCode</span><span class="o">(</span><span class="n">errorCode</span><span class="o">);</span>
                                <span class="n">response</span><span class="o">.</span><span class="na">setStatusMessage</span><span class="o">(</span><span class="n">HttpResponseStatus</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">errorCode</span><span class="o">).</span><span class="na">reasonPhrase</span><span class="o">());</span>
                                <span class="n">response</span><span class="o">.</span><span class="na">end</span><span class="o">(</span><span class="n">HttpResponseStatus</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">errorCode</span><span class="o">).</span><span class="na">reasonPhrase</span><span class="o">());</span>
                            <span class="o">}</span>
                        <span class="o">}</span>
                    <span class="o">}</span>
                <span class="o">}.</span><span class="na">handle</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-39"><td class="docs"><div class="pilwrap"><a href="#section-39" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deploys required middleware</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">config</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">deploy</span><span class="o">(</span><span class="n">JsonElement</span> <span class="n">config</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">deploy</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span></pre></div></td></tr><tr id="section-40"><td class="docs"><div class="pilwrap"><a href="#section-40" class="pilcrow">&#182;</a></div><div class="dox"><div class="summary"><p>Deploys required middleware</p></div><div class="details"><div class="dox_tag_title">Params</div><div class="dox_tag_detail"><span> </span><span class="dox_type">config</span></div><div class="dox_tag_detail"><span> </span><span class="dox_type">handler</span></div></div><div class="body"></div></div>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">public</span> <span class="n">Yoke</span> <span class="nf">deploy</span><span class="o">(</span><span class="n">JsonElement</span> <span class="n">config</span><span class="o">,</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">AsyncResult</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">config</span><span class="o">.</span><span class="na">isArray</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">Object</span> <span class="n">o</span> <span class="o">:</span> <span class="n">config</span><span class="o">.</span><span class="na">asArray</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">JsonObject</span> <span class="n">mod</span> <span class="o">=</span> <span class="o">(</span><span class="n">JsonObject</span><span class="o">)</span> <span class="n">o</span><span class="o">;</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;module&quot;</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">deploy</span><span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;module&quot;</span><span class="o">),</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">mod</span><span class="o">.</span><span class="na">getInteger</span><span class="o">(</span><span class="s">&quot;instances&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&quot;config&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonObject</span><span class="o">()),</span> <span class="n">handler</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">deploy</span><span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;verticle&quot;</span><span class="o">),</span> <span class="kc">false</span><span class="o">,</span> <span class="n">mod</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">&quot;worker&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">&quot;multiThreaded&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getInteger</span><span class="o">(</span><span class="s">&quot;instances&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&quot;config&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonObject</span><span class="o">()),</span> <span class="n">handler</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">JsonObject</span> <span class="n">mod</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">asObject</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;module&quot;</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">deploy</span><span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;module&quot;</span><span class="o">),</span> <span class="kc">true</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="kc">false</span><span class="o">,</span> <span class="n">mod</span><span class="o">.</span><span class="na">getInteger</span><span class="o">(</span><span class="s">&quot;instances&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&quot;config&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonObject</span><span class="o">()),</span> <span class="n">handler</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">deploy</span><span class="o">(</span><span class="n">mod</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&quot;verticle&quot;</span><span class="o">),</span> <span class="kc">false</span><span class="o">,</span> <span class="n">mod</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">&quot;worker&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getBoolean</span><span class="o">(</span><span class="s">&quot;multiThreaded&quot;</span><span class="o">,</span> <span class="kc">false</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getInteger</span><span class="o">(</span><span class="s">&quot;instances&quot;</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="n">mod</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="s">&quot;config&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">JsonObject</span><span class="o">()),</span> <span class="n">handler</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">deploy</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">module</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">worker</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">multiThreaded</span><span class="o">,</span> <span class="kt">int</span> <span class="n">instances</span><span class="o">,</span> <span class="n">JsonObject</span> <span class="n">config</span><span class="o">,</span> <span class="n">Handler</span><span class="o">&lt;</span><span class="n">AsyncResult</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span> <span class="n">handler</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">module</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">container</span><span class="o">.</span><span class="na">deployModule</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">container</span><span class="o">.</span><span class="na">deployModule</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">worker</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">container</span><span class="o">.</span><span class="na">deployWorkerVerticle</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">,</span> <span class="n">multiThreaded</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">container</span><span class="o">.</span><span class="na">deployWorkerVerticle</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">,</span> <span class="n">multiThreaded</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">handler</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">container</span><span class="o">.</span><span class="na">deployVerticle</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">,</span> <span class="n">handler</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                    <span class="n">container</span><span class="o">.</span><span class="na">deployVerticle</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">config</span><span class="o">,</span> <span class="n">instances</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Thu Jan 30 2014 16:30:29 GMT+0100 (CET)  </div><div id="projectname"><a href="../../../../../../../../index.html">Yoke</a></div></div></body></html>