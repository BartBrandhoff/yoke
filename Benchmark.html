<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-02-23 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150223" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Yoke micro-framework - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarEnabled">
          
    
    
            
    
        
    <a href="http://github.com/apache/maven-skins">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                        
                    
                

    <div id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
                                  <div class="container" style="width: 90%;"><div class="nav-collapse">
            
                
                                                                                <a class="brand" href="index.html" >

                                
                                    Yoke
                
                </a>
                    
                                <ul class="nav">
                          <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Middleware <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="middleware/basic-auth.html"  title="Basic Auth">Basic Auth</a>
</li>
                  
                      <li>      <a href="middleware/body-parser.html"  title="Body Parser">Body Parser</a>
</li>
                  
                      <li>      <a href="middleware/bridge-secure-handler.html"  title="Bridge Secure Handler">Bridge Secure Handler</a>
</li>
                  
                      <li>      <a href="middleware/compress.html"  title="Compress">Compress</a>
</li>
                  
                      <li>      <a href="middleware/cookie-parser.html"  title="Cookie Parser">Cookie Parser</a>
</li>
                  
                      <li>      <a href="middleware/cors.html"  title="CORS">CORS</a>
</li>
                  
                      <li>      <a href="middleware/csrf.html"  title="CSRF">CSRF</a>
</li>
                  
                      <li>      <a href="middleware/error-handler.html"  title="Error Handler">Error Handler</a>
</li>
                  
                      <li>      <a href="middleware/favicon.html"  title="Favicon">Favicon</a>
</li>
                  
                      <li>      <a href="middleware/form-auth.html"  title="Form Auth">Form Auth</a>
</li>
                  
                      <li>      <a href="middleware/jwt.html"  title="JWT">JWT</a>
</li>
                  
                      <li>      <a href="middleware/limit.html"  title="Limit">Limit</a>
</li>
                  
                      <li>      <a href="middleware/logger.html"  title="Logger">Logger</a>
</li>
                  
                      <li>      <a href="middleware/method-override.html"  title="Method Override">Method Override</a>
</li>
                  
                      <li>      <a href="middleware/request-proxy.html"  title="Request Proxy">Request Proxy</a>
</li>
                  
                      <li>      <a href="middleware/response-headers.html"  title="Response Headers">Response Headers</a>
</li>
                  
                      <li>      <a href="middleware/router.html"  title="Router">Router</a>
</li>
                  
                      <li>      <a href="middleware/session.html"  title="Session">Session</a>
</li>
                  
                      <li>      <a href="middleware/static.html"  title="Static">Static</a>
</li>
                  
                      <li>      <a href="middleware/timeout.html"  title="Timeout">Timeout</a>
</li>
                  
                      <li>      <a href="middleware/vhost.html"  title="VHost">VHost</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorial <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li>      <a href="tutorial/java.html"  title="Java">Java</a>
</li>
                          </ul>
      </li>
                <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
        
                      <li class="dropdown-submenu">
                                      <a href="project-info.html"  title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="dependencies.html"  title="Dependencies">Dependencies</a>
</li>
                                  <li>      <a href="team-list.html"  title="Project Team">Project Team</a>
</li>
                                  <li>      <a href="integration.html"  title="Continuous Integration">Continuous Integration</a>
</li>
                                  <li>      <a href="issue-tracking.html"  title="Issue Tracking">Issue Tracking</a>
</li>
                                  <li>      <a href="license.html"  title="Project License">Project License</a>
</li>
                                  <li>      <a href="source-repository.html"  title="Source Repository">Source Repository</a>
</li>
                              </ul>
            </li>
                  
                      <li class="dropdown-submenu">
                                      <a href="project-reports.html"  title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                                  <li>      <a href="apidocs/index.html"  title="JavaDocs">JavaDocs</a>
</li>
                                  <li>      <a href="testapidocs/index.html"  title="Test JavaDocs">Test JavaDocs</a>
</li>
                                  <li>      <a href="cobertura/index.html"  title="Cobertura Test Coverage">Cobertura Test Coverage</a>
</li>
                              </ul>
            </li>
                          </ul>
      </li>
                  </ul>
          
          
                                                                            
                   
                      </div>
          
        </div>
      </div>
    </div>
    
        <div class="container">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Yoke micro-framework</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-02-23
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 2.0.13
                      </li>
                      
                
                    
      
                            </ul>
      </div>

      
                
        <div id="bodyColumn" >
                                  
            <p>Yoke has a simple benchmark to compare to ExpressJS, these benchmarks are too simple and do not represent real world scenarios. Proper benchmarking should be done comparing what you need and not just serving static text or json resources.</p>
<div class="section">
<h2>ExpressJS code<a name="ExpressJS_code"></a></h2>

<div class="source">
<pre>var express = require('express');
var app = express();

app.configure(function(){
    app.use(express.bodyParser());
});

app.get('/', function(req, res){
    res.send('Hello World\n');
});

app.get('/json', function(req, res){
    res.send({ name: 'Tobi', role: 'admin' });
});

function foo(req, res, next) {
    next();
}

app.get('/middleware', foo, foo, foo, foo, function(req, res){
    res.send('1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890');
});

app.listen(8000);
</pre></div>
<p>This application was running node <i>v0.10.3</i> and express <i>3.2.4</i> and in a single thread.</p></div>
<div class="section">
<h2>Yoke code<a name="Yoke_code"></a></h2>

<div class="source">
<pre>public class YokeBench extends Verticle {

    @Override
    public void start() {

        final Middleware foo = new Middleware() {
            @Override
            public void handle(YokeRequest request, Handler&lt;Object&gt; next) {
                next.handle(null);
            }
        };

        new Yoke(vertx)
                .use(new BodyParser())
                .use(&quot;/middleware&quot;, foo)
                .use(&quot;/middleware&quot;, foo)
                .use(&quot;/middleware&quot;, foo)
                .use(&quot;/middleware&quot;, foo)
                .use(new Router()
                        .get(&quot;/&quot;, new Handler&lt;YokeRequest&gt;() {
                            @Override
                            public void handle(YokeRequest request) {
                                request.response().end(&quot;Hello World\n&quot;);
                            }
                        })
                        .get(&quot;/json&quot;, new Handler&lt;YokeRequest&gt;() {
                            @Override
                            public void handle(YokeRequest request) {
                                request.response().end(new JsonObject().putString(&quot;name&quot;, &quot;Tobi&quot;).putString(&quot;role&quot;, &quot;admin&quot;));
                            }
                        })
                        .get(&quot;/middleware&quot;, new Handler&lt;YokeRequest&gt;() {
                            @Override
                            public void handle(YokeRequest request) {
                                request.response().end(&quot;1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890&quot;);
                            }
                        })
                ).listen(8080);
    }
}
</pre></div>
<p>This application was running java <i>1.7.0_21 (Oracle)</i>, yoke <i>1.0.0-SNAPSHOT</i> and vert.x <i>2.0.0-SNAPSHOT</i> and in a single thread.</p></div>
<div class="section">
<h2>Cluster<a name="Cluster"></a></h2>
<p>Although <b>both</b> frameworks run in a single Thread, in a real production environment you might want to use all your cores to get all the performance out of the box.</p></div>
<div class="section">
<h2>ExpressJS code<a name="ExpressJS_code"></a></h2>

<div class="source">
<pre>// Include the cluster module
var cluster = require('cluster');

// Code to run if we're in the master process
if (cluster.isMaster) {

    // Count the machine's CPUs
    var cpuCount = require('os').cpus().length;

    // Create a worker for each CPU
    for (var i = 0; i &lt; cpuCount; i += 1) {
        cluster.fork();
    }

    // Listen for dying workers
    cluster.on('exit', function (worker) {

        // Replace the dead worker, we're not sentimental
        console.log('Worker ' + worker.id + ' died :(');
        cluster.fork();

    });

// Code to run if we're in a worker process
} else {

    // Include Express
    var express = require('express');

    // Create a new Express application
    var app = express();

    // Add a basic route &#x2013; index page
    app.get('/', function (req, res) {
        res.send('Hello World\n');
    });

    // Bind to a port
    app.listen(3000);
    console.log('Worker ' + cluster.worker.id + ' running!');

}
</pre></div>
<p>Lots of code here!</p></div>
<div class="section">
<h2>Yoke code<a name="Yoke_code"></a></h2>

<div class="source">
<pre>public class YokeBench extends Verticle {

    @Override
    public void start() {

        new Yoke(vertx)
                .use(new Router()
                        .get(&quot;/&quot;, new Handler&lt;YokeRequest&gt;() {
                            @Override
                            public void handle(YokeRequest request) {
                                request.response().end(&quot;Hello World\n&quot;);
                            }
                        })
                ).listen(8080);
    }
}
</pre></div>
<p>As you can read Yoke code is cleaner and it is not the concern of the developer to implement forking as that is managed by the underlying Vert.x framework.</p></div>
<div class="section">
<h2>Results<a name="Results"></a></h2>
<div class="section">
<h3>Serving text<a name="Serving_text"></a></h3>
<p><img src="text.png" alt="Hello World expressJS vs Yoke" /></p>
<p>As it can be seem Yoke is faster and scales the same way ExpressJS does.</p></div>
<div class="section">
<h3>Serving json<a name="Serving_json"></a></h3>
<p><img src="json.png" alt="JSON expressJS vs Yoke" /></p>
<p>As it can be seem Yoke is faster and scales the same way ExpressJS does.</p></div>
<div class="section">
<h3>Middleware<a name="Middleware"></a></h3>
<p><img src="middleware.png" alt="Middleware expressJS vs Yoke" /></p>
<p>As it can be seem Yoke is faster and scales the same way ExpressJS does.</p></div></div>
<div class="section">
<h2>Cluster Results<a name="Cluster_Results"></a></h2>
<p><img src="cluster.png" alt="Cluster expressJS vs Yoke" /></p>
<p>Running the benchmark using 4 workers (the test machine has 4 cores) both with Express and Yoke you can see that Yoke is a clear winner.</p></div>
<div class="section">
<h2>Conclusions<a name="Conclusions"></a></h2>
<p>These benchmarks are quite naive but give you a good impression that if you have a fast expressJS application and you port it to Yoke you will get some more performance and the expected scalability.</p></div>
                  </div>
          </div>

    <hr/>

    <footer>
            <div class="container">
                      <div class="row">
                              <p >Copyright &copy;                   2015.
          All rights reserved.      
                    
      </p>
        </div>

        
                <p id="poweredBy" class="pull-right">
                          <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
              </p>
        
                </div>
    </footer>
        </body>
</html>
